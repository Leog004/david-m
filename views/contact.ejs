<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Theme Region">
       	<meta name="description" content="">

        <title>David M</title>

         <!-- Fonts -->
        <link href='https://fonts.googleapis.com/css?family=Cookie' rel='stylesheet' type='text/css'>
		
        <!-- icons -->
 

        <!-- CSS -->
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/font-awesome.min.css">  
        <link rel="stylesheet" href="css/jplayer.css"> 
        <link rel="stylesheet" href="css/beat.css">         
        <link rel="stylesheet" href="css/magnific-popup.css">
        <link rel="stylesheet" href="css/owl.carousel.css">      
        <link rel="stylesheet" href="css/cubeportfolio.min.css">      
        <link rel="stylesheet" href="css/main.css"> 
        <link rel="stylesheet" href="css/responsive.css">         
        

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
    <style>

        #navigation .navbar:after,  #navigation .navbar:before{
            border-top: 30px solid transparent;
            background-color: transparent;
        }
        
        .video-overlay {
        
            background-color:rgb(0,0,0,0.4) !important;
        }
        .homevid{
            width:50%;
        }
        
        .btn.btn-primary{
        
            background-color:#000;
            border: 1px solid #000;
        }
        
        .btn.btn-primary::hover{
            color:#000 !important;
        }        
        
        @media (max-width: 991px){
         .homevid{
            width:100%;
            margin: 40px 0;
        }         
                
                .band-banner .home-content h1, .home-banner.biography .home-content h1 {
                 font-size: 45px;
                  line-height: 42px;
            }
        }
    </style>

    <script src='https://www.google.com/recaptcha/api.js?render=6Lek1a0nAAAAAO2iiCl_KROMqmAV4CNldZmvBD1t'></script>

    </head>
    <body>
        <% include partials/header %>

                <!-- Set all my variables -->
                <% var backgroundImage = contactPage?.headerImage?.url || 'images/DavidP/IMG_6469.png'; %>
                <% var headerText = contactPage?.headerTitle || 'Contact Me'; %>
                <% var text = contactPage?.text || ''; %>

                <div class="feedback section-padding before-after" style="margin-top:80px;">
                    <div class="entry-post" style="background-image:url('<%= backgroundImage %>'); height:50vh;background-size: cover; background-repeat: no-repeat;background-position: center;">
                        <% include partials/social %>              
                    </div>                     
            <div class="container">
                <div class="feedback-content">
                    <h1><%= headerText %></h1>
                    <!-- if text -->
                    <% if (text) { %>
                        <p style="margin-top: -40px; margin-bottom: 30px;"><%= text  %></p>
                    <% } %>
                    <form id="contact-form" class="contact-form" name="contact-form" method="post" action="/contact">
                        <div class="row">
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label for="name">Name</label>
                                    <input name="name" type="text" class="form-control" required="required" id="name">
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label for="email">Email</label>
                                    <input name="email" type="email" class="form-control" required="required" id="email">
                                </div> 
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label for="subject">Subject</label>
                                    <input name="subject" type="text" class="form-control" required="required" id="subject">
                                </div> 
                            </div>
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label for="message">Your Text</label>
                                    <textarea name="message" required="required" class="form-control" rows="7" id="message"></textarea>
                                </div>             
                            </div>
                            <input type="hidden" name="recaptchaResponse" id="recaptchaResponse">     
                        </div>
                        <div class="form-group text-center">
                            <button type="submit" id="contact-btn" class="btn btn-primary pull-right">Submit now!</button>
                        </div>
                    </form><!-- contact form --> 
                </div>
            </div><!-- container --> 
        </div><!-- feedback -->   
<!-- partials footer -->
<% include partials/footer %>


        <!-- JS -->
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>      
        <script src="js/gmaps.min.js"></script>          
        <script src="js/jquery.jplayer.min.js"></script> 
        <script src="js/jplayer.playlist.min.js"></script> 
        <script src="js/jquery.plugin.js"></script> 
        <script src="js/jquery.countdown.js"></script>    
        <script src="js/magnific-popup.min.js"></script>    
        <script src="js/jquery.backstretch.min.js"></script>
        <script src="js/owl.carousel.min.js"></script> 
        <script src="js/inview.min.js"></script> 
        <script src="js/jquery.spinner.min.js"></script> 
        <script src="js/cubeportfolio.min.js"></script>    
        <script src="js/jplayer.source.js"></script>
        <script src="js/main.js"></script>         

        <script>
            if (window.location.href.includes('?status=success')) {
                // Display success message to the user
                const successMessageHTML = `
                        <div class="alert alert-success" role="alert">
                            <strong>Success!</strong> Your message has been sent.
                        </div>
                    `;
                
                    
                const form = document.getElementById('contact-form');
                form.insertAdjacentHTML('beforebegin', successMessageHTML);
                
            }

            else if (window.location.href.includes('?status=fail')) {
                // Display error message to the user
                const errorMessageHTML = `
                        <div class="alert alert-danger" role="alert">
                            <strong>Error!</strong> Your message could not be sent.
                        </div>
                    `;
                
                    
                const form = document.getElementById('contact-form');
                form.insertAdjacentHTML('beforebegin', errorMessageHTML);
                
            }

            document.addEventListener('DOMContentLoaded', function () {
                const form = document.getElementById('contact-form');
                form.addEventListener('submit', function (event) {
                    event.preventDefault(); // Prevent the default form submission

                    grecaptcha.ready(function () {
                        grecaptcha.execute('6Lek1a0nAAAAAO2iiCl_KROMqmAV4CNldZmvBD1t', { action: 'submit' }).then(function (token) {
                            document.getElementById('recaptchaResponse').value = token; // Assuming you have an input in your form to handle this token
                            verifyRecaptcha(token);
                        });
                    });
                });

                function verifyRecaptcha(token) {
                    $.ajax({
                        type: "POST",
                        url: "/verifyRecaptcha", // Endpoint to verify the token
                        data: {
                            token: token
                        },
                        success: function (response) {
                            if (response.success) {
                                form.submit(); // Submit the form if reCAPTCHA is successful
                            } else {
                                alert("reCAPTCHA verification failed. Please try again.");
                            }
                        },
                        error: function () {
                            alert("Error verifying reCAPTCHA. Please try again later.");
                        }
                    });
                }
            });
        </script>

    </body>
</html>